<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="InfiniDepth Project Page">
    <meta name="author" content="Hao Yu">
    <title>InfiniDepth</title>
    
    <!-- Bootstrap & Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- InfiniDepth Styles -->
    <link href="css/infinidepth/main.css" rel="stylesheet">
    <link href="css/infinidepth/title-animations.css" rel="stylesheet">
    <link href="css/infinidepth/magnifier.css" rel="stylesheet">

    <!-- Three.js for Point Cloud Viewer -->
    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    <style>
    .section-card {
        background: #fff !important;
        border-radius: 14px !important;
        box-shadow: 0 1px 6px rgba(80,120,180,0.03) !important;
        /* 核心 */
        padding: 18px 24px !important;   /* ↑↓ 18px，←→ 28px */
    }
    /* Citation 区域整体 */
    .section-card pre,
    .section-card pre code {
    color: #4a5a6a;          /* 淡灰蓝 */
    background: #f7f9fb;     /* 很浅的灰背景 */
    }
    section {
      margin-bottom: 2px !important;
      padding-bottom: 0 !important;
    }
    
    /* Visualization Switch */
    .viz-switch {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin: 12px 0 16px 0;
    }

    .viz-btn {
    border: 1px solid #cfd6df;
    background: #f7f9fc;
    color: #345;
    padding: 6px 18px;
    border-radius: 999px;
    font-size: 0.95rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    }

    .viz-btn.active {
    background: #345;
    color: #fff;
    border-color: #345;
    }

    .viz-content {
    display: none;
    }

    .viz-content.active {
    display: block;
    }

    /* 压缩封面 section（标题区）垂直高度 */
    .jumbotron.text-center.mt-0 {
      padding-top: 18px !important;
      padding-bottom: 18px !important;
      margin-bottom: 0 !important;
    }
    .jumbotron .container {
      padding-top: 0 !important;
      padding-bottom: 0 !important;
    }
    .jumbotron h1 {
      font-size: 2.1rem !important;
      margin-bottom: 0.3em !important;
      margin-top: 0.2em !important;
    }
    .jumbotron h4 {
      font-size: 1.1rem !important;
      margin-bottom: 0.2em !important;
      margin-top: 0.2em !important;
    }
    .jumbotron hr {
      margin: 0.2em 0 0.5em 0 !important;
    }
    .author-list, .author-row {
      margin-bottom: 0.2em !important;
      margin-top: 0 !important;
    }
    .jumbotron p {
      margin-top: 0.2em !important;
      margin-bottom: 0.2em !important;
    }
    .jumbotron .row.justify-content-center {
      margin-top: 0.2em !important;
      margin-bottom: 0.2em !important;
    }
    .jumbotron .column p {
      margin-bottom: 0.2em !important;
      margin-top: 0.2em !important;
    }
    @media (max-width: 700px) {
      .jumbotron h1 {
        font-size: 1.25rem !important;
      }
      .jumbotron h4 {
        font-size: 0.98rem !important;
      }
      .jumbotron {
        padding-top: 10px !important;
        padding-bottom: 10px !important;
      }
    }
    /* ===== Cover 作者名字字体调小 ===== */
    .jumbotron .author-list a {
        font-size: 1.1rem !important;   /* 原来 ~1rem */
        font-weight: 400;             /* 保持清晰但不抢标题 */
        }
    .jumbotron .author-row {
        margin-bottom: 0.01em !important;
        }
    /* 单位信息 */
    .jumbotron p:not([style]) {
        font-size: 1.1rem !important;
        font-weight: 400;    
        }
    .jumbotron .btn {
        font-size: 0.95rem !important;
        padding: 8px 16px !important;
        }

    /* ===== Cover 标题微调（更有气场但不臃肿） ===== */
    /* 整个 cover 顶部留白稍微加一点 */
    .jumbotron.text-center.mt-0 {
        padding-top: 27px !important;   /* 原来 18px */
        }

    /* 主标题：稍微大一点点 */
    .jumbotron h1 {
        font-size: 2.15rem !important;  /* 原来 2.1rem */
        line-height: 1.26 !important;
        margin-top: 1.1em;  /* 离顶部更舒展 */
        margin-bottom: 0.45em;
        }

    /* 副标题 Arxiv 2025 */
    .jumbotron h4 {
        font-size: 1.1rem;  /* 原来 1.1rem，其实略微回调 */
        font-weight: 500;   
        margin-top: 0.25em ;
        margin-bottom: 0.45em;
        }
    
    .viz-description {
        margin-top: 7px;
        margin-bottom: 15px;
        text-align: center;
        }

    .viz-desc {
        display: none;
        font-size: 0.97rem;
        color: #5a6b7c;
        line-height: 1.5;
        }

    .viz-desc.active {
        display: block;
        }

    .showcase-bar {
    display: flex;
    justify-content: center;
    gap: 18px;

    margin: 26px 0 10px 0;
    padding: 18px 0;

    position: relative;
    background: none;
    box-shadow: none;
    border-radius: 0;

    /* 中央轨道：从中间向两端自然消散 */
    background:
        radial-gradient(
        ellipse at center,
        rgba(100, 168, 240, 0.1) 0%,
        rgba(100, 168, 240, 0.08) 30%,
        rgba(100, 168, 240, 0.045) 55%,
        rgba(100, 168, 240, 0.0) 75%
        );
    }

    /* 上方短虚线 */
    .showcase-bar::before,
    .showcase-bar::after {
    content: '';
    position: absolute;
    left: 22%;
    right: 22%;
    height: 2px;

    background: repeating-linear-gradient(
        to right,
        rgba(52, 85, 120, 0.28),
        rgba(52, 85, 120, 0.28) 8px,
        transparent 8px,
        transparent 16px
    );

    pointer-events: none;
    }

    /* 上虚线 */
    .showcase-bar::before {
    top: 0;
    }

    /* 下虚线 */
    .showcase-bar::after {
    bottom: 0;
    }

    .showcase-thumb {
      width: 110px;
      height: 82px;
      object-fit: cover;
      border-radius: 10px;
      border: 2.5px solid #e3e8ef;
      cursor: pointer;
      transition: border 0.18s, transform 0.18s, box-shadow 0.18s, filter 0.18s;
      box-shadow: 0 2px 10px rgba(80,120,180,0.09);
      background: #f7f9fb;
      filter: grayscale(0.12) brightness(0.98);
    }
    .showcase-thumb.active {
      border: 3px solid #345;
      box-shadow: 0 4px 18px rgba(80,120,180,0.18);
      transform: scale(1.12) translateY(-6px);
      z-index: 2;
      filter: none;
    }
    .showcase-thumb:hover {
      filter: none;
      border-color: #a9b8c9;
      transform: scale(1.07) translateY(-2px);
    }
    .showcase-thumb:active {
      border-color: #a9b8c9;
      transform: scale(0.97);
    }
    </style>
</head>

<body>
    <!-- Cover Section -->
    <section>
        <div class="jumbotron text-center mt-0">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <h1>
                            <span class="title-main">InfiniDepth</span>: 
                            <span class="title-resolution">Arbitrary-Resolution</span> and 
                            <span class="title-finegrained">Fine-Grained</span> Depth Estimation with 
                            <span class="title-neural">Neural Implicit Fields</span>
                        </h1>
                        <h4>Arxiv 2025</h4>
                        <hr>
                        <div class="author-list">
                            <div class="author-row">
                                <a href="https://ritianyu.github.io/" target="_blank">Hao Yu<sup>1,2*</sup></a>
                                <a href="https://haotongl.github.io/" target="_blank">Haotong Lin<sup>1*</sup></a>
                                <a href="https://github.com/PLUS-WAVE" target="_blank">Jiawei Wang<sup>1*</sup></a>
                                <a href="https://github.com/Dustbin-Li" target="_blank">Jiaxin Li<sup>1</sup></a>
                                <a href="https://wangyida.github.io/" target="_blank">Yida Wang<sup>2</sup></a>
                                <a href="#" target="_blank">Xueyang Zhang<sup>2</sup></a>
                                <a href="https://ywang-zju.github.io/" target="_blank">Yue Wang<sup>1</sup></a>
                            </div>
                            <div class="author-row">
                                <a href="https://xzhou.me/" target="_blank">Xiaowei Zhou<sup>1</sup></a>
                                <a href="https://csse.szu.edu.cn/staff/ruizhenhu/" target="_blank">Ruizhen Hu<sup>3</sup></a>
                                <a href="https://pengsida.net/" target="_blank">Sida Peng<sup>1†</sup></a>
                            </div>
                        </div>
                        <p>
                            <sup>1</sup>Zhejiang University &nbsp;&nbsp;
                            <sup>2</sup>Li Auto &nbsp;&nbsp;
                            <sup>3</sup>Shenzhen University
                        </p>
                        <p style="font-size: 0.95rem; color: #6c757d; margin-top: 0.5rem;">
                            <sup>*</sup>Equal contribution &nbsp;&nbsp;
                            <sup>†</sup>Corresponding author
                        </p>
                        
                        <!-- Buttons -->
                        <div class="row justify-content-center">
                            <div class="column">
                                <p class="mb-5">
                                    <a class="btn btn-large btn-light" href="paper.pdf" role="button" target="_blank">
                                        <i class="ai ai-arxiv"></i>Paper
                                    </a>
                                </p>
                            </div>
                            <div class="column">
                                <p class="mb-5">
                                    <a class="btn btn-large btn-light" href="https://github.com/RitianYu/project" role="button" target="_blank">
                                        <i class="fa fa-github"></i>Code
                                    </a>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- TL;DR Section -->
    <section>
        <div class="container">
            <div class="row">
                <div class="col-12">
                   <div class="section-card">
                        <h3 style="font-size:1.5rem; margin-bottom:10px; color:#345; font-weight:600;">TL;DR</h3>
                        <ul style="margin-left:18px; margin-bottom:0; line-height:1.8; font-size:1.01rem; color:#3a4a5a;">
                            <li>This paper introduces <strong class="title-main">InfiniDepth</strong>, a novel monocular depth estimation method with <span class="title-neural">neural implicit fields</span>.
                                It leverages continuous coordinate queries to enable <span class="title-resolution">arbitrary resolutions</span> and <span class="title-finegrained">fine-grained</span> depth estimation.</li>
                            <li>We design a <strong>depth query strategy</strong> along with a <strong>Gaussian decoder</strong> to improve novel view synthesis quality, especially under large viewpoint shifts.</li>
                            <li>We curate <strong>Synth4K</strong>, a high-quality 4K benchmark for evaluating depth estimation methods at high resolution and fine geometric details.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- overview section -->
    <section>
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="section-card">
                        <h3 style="font-size:1.5rem; margin-bottom:17px; color:#345; font-weight:600;">Overview</h3>
                        <!-- <h3>Overview</h3> -->
                        <div style="display: flex; justify-content: center; align-items: center;">
                            <video id="overviewVideo" controls style="width: 100%; height: auto; border-radius: 12px; box-shadow: 0 4px 24px rgba(0,0,0,0.12);">
                                <source src="images/pub/infinidepth/demo_speed_compress_2.mov" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                        <div class="overview-stage-bar">
                            <button class="overview-stage-btn" id="stage-btn-1" onclick="seekOverviewVideo(0)">Depth Map at 16K-Resolution</button>
                            <button class="overview-stage-btn" id="stage-btn-2" onclick="seekOverviewVideo(18)">Fine-Grained Point Clouds</button>
                            <button class="overview-stage-btn" id="stage-btn-3" onclick="seekOverviewVideo(24)">Single-View NVS under Large ViewPoint Shifts</button>
                        </div>
                        <style>
                        .overview-stage-bar {
                          background: #f5f7fa;
                          border-radius: 12px;
                          padding: 10px 10px 6px 10px;
                          margin: 16px auto 0 auto;
                          display: flex;
                          justify-content: center;
                          gap: 10px;
                          box-shadow: 0 2px 12px rgba(80,120,180,0.03); 
                          max-width: 800px;
                        }
                        .overview-stage-btn {
                          background: none;
                          border: none;
                          border-radius: 8px;
                          padding: 0.28em 0.7em;
                          font-size: 0.93rem;
                          font-family: 'Jost', 'Segoe UI', Arial, sans-serif;
                          font-weight: 500;
                          color: #345;
                          transition: background 0.18s, color 0.18s;
                          cursor: pointer;
                          outline: none;
                        }
                        .overview-stage-btn:hover, .overview-stage-btn:focus {
                          background: #e3eaf2;
                        }
                        .overview-stage-btn.active {
                          background: #a9b8c9 !important;
                          color: #fff !important;
                        }
                        @media (max-width: 700px) {
                          .overview-stage-bar {
                            flex-direction: column;
                            gap: 6px;
                            padding: 8px 4px 4px 4px;
                          }
                          .overview-stage-btn {
                            font-size: 0.91rem;
                            padding: 0.22em 0.5em;
                          }
                        }
                        </style>
                        <script>
                        (function () {
                        const video = document.getElementById('overviewVideo');
                        if (!video) return;

                        const btns = [
                            document.getElementById('stage-btn-1'),
                            document.getElementById('stage-btn-2'),
                            document.getElementById('stage-btn-3'),
                        ];

                        // 这里用“高亮阈值”，而不是跳转点
                        // 0-7 -> 1, 7-17 -> 2, >=17 -> 3
                        const stageThresholds = [2, 18, 24];

                        // 这里用“跳转点”
                        const seekTimes = [2, 18, 24];

                        // 用户点击优先级锁
                        let userOverrideIdx = null;   // 当前用户强制选择的按钮 idx
                        let userOverrideUntil = 0;    // 在这个时间戳之前，自动高亮不允许覆盖
                        let pendingSeek = null;       // 防止 metadata 未加载导致 seek 失败

                        function setActive(idx) {
                            btns.forEach((b, i) => b && b.classList.toggle('active', i === idx));
                        }

                        function getAutoStageIdx(t) {
                            if (t >= stageThresholds[2]) return 2;
                            if (t >= stageThresholds[1]) return 1;
                            return 0;
                        }

                        function doSeekTo(idx) {
                            const seekTo = () => {
                            const target = seekTimes[idx];
                            // 先强制高亮（立刻反馈）
                            setActive(idx);

                            // 设置用户优先级：例如 900ms 内不允许 timeupdate 覆盖
                            userOverrideIdx = idx;
                            userOverrideUntil = Date.now() + 900;

                            // 再跳转播放
                            const t = Math.min(target, (video.duration || target));
                            video.currentTime = t;
                            video.play();
                            };

                            // metadata 未加载时，等 loadedmetadata 再跳
                            if (video.readyState < 1) {
                            pendingSeek = idx;
                            video.addEventListener('loadedmetadata', () => {
                                if (pendingSeek !== null) {
                                const i = pendingSeek;
                                pendingSeek = null;
                                doSeekTo(i);
                                }
                            }, { once: true });
                            } else {
                            seekTo();
                            }
                        }

                        // 暴露给 HTML onclick 用
                        window.seekOverviewVideo = function (timeOrIdx) {
                            // 你原来 onclick 传的是秒数，这里兼容：传秒数就映射到最近的 idx
                            let idx = 0;
                            if (typeof timeOrIdx === 'number') {
                            // 如果传的是 2/12/22，映射成 idx
                            const i = seekTimes.indexOf(timeOrIdx);
                            idx = (i >= 0) ? i : 0;
                            }
                            doSeekTo(idx);
                        };

                        // 给按钮绑定点击：优先级最高
                        btns.forEach((b, idx) => {
                            if (!b) return;
                            b.addEventListener('click', (e) => {
                            e.preventDefault();
                            doSeekTo(idx);
                            });
                        });

                        // 自动高亮：被用户锁短暂压制；一旦视频进入对应段也可解除锁
                        function updateStageBtn() {
                            const now = Date.now();

                            // 如果用户刚点击过，优先显示用户选择
                            if (userOverrideIdx !== null) {
                            setActive(userOverrideIdx);

                            // 两种解除方式：超时 或 视频已经进入用户选择的阶段
                            const autoIdx = getAutoStageIdx(video.currentTime);
                            if (now >= userOverrideUntil || autoIdx === userOverrideIdx) {
                                userOverrideIdx = null;
                            }
                            return;
                            }

                            // 没有用户锁 -> 正常自动高亮
                            setActive(getAutoStageIdx(video.currentTime));
                        }

                        video.addEventListener('timeupdate', updateStageBtn);
                        video.addEventListener('seeking', updateStageBtn);
                        video.addEventListener('seeked', updateStageBtn);

                        // 初始
                        updateStageBtn();
                        })();
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Abstract Section -->
    <section>
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="section-card">
                        <h3 style="font-size:1.5rem; margin-bottom:17px; color:#345; font-weight:600;">Abstract</h3>
                        <p style="text-align: justify;">
                            Existing depth estimation methods are fundamentally limited to predicting depth on discrete image grids. Such representations restrict their scalability to arbitrary output resolutions and hinder the geometric detail recovery.
                            This paper introduces <strong>InfiniDepth</strong>, which represents depth as neural implicit fields.
                            Through a simple yet effective local implicit decoder, we can query depth at continuous 2D coordinates, enabling arbitrary-resolution and fine-grained depth estimation.
                            To better assess our method's capabilities, we curate a high-quality 4K synthetic benchmark from five different games, spanning diverse scenes with rich geometric and appearance details.
                            Extensive experiments demonstrate that InfiniDepth achieves state-of-the-art performance on both synthetic and real-world benchmarks across relative and metric depth estimation tasks, particularly excelling in fine-detail regions.
                            It also benefits the task of novel view synthesis under large viewpoint shifts, producing high-quality results with fewer holes and artifacts.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Method Section -->
    <section>
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="section-card">
                        <h3 style="font-size:1.5rem; margin-bottom:17px; color:#345; font-weight:600;">Method</h3>
                        <div style="display: flex; justify-content: center;">
                            <img src="images/pub/infinidepth/pipeline.jpg" width="100%" alt="Method">
                        </div>
                        <br>
                        <p style="text-align: justify;"><strong>Pipeline of InfiniDepth:</strong></p>
                        <ul style="margin-left: 30px; line-height: 2; text-align: justify;">
                            <li><strong>Feature Query:</strong> given an input image and a continuous query 2D coordinate, we extract feature tokens from multiple layers of the ViT encoder, and query local features for the coordinate at each scale through bilinear interpolation.</li>
                            <li><strong>Depth Decoding:</strong> given the multi-scale local features queried at the continuous coordinate, we hierarchically fuse features from high spatial resolution to low spatial resolution, and decode the fused feature to the depth value through a MLP head.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Qualitative Visualization Section -->
    <section>
    <div class="container">
        <div class="row">
        <div class="col-12">
            <div class="section-card">
            <h3 style="font-size:1.5rem; margin-bottom:17px; color:#345; font-weight:600;">Qualitative Visualization</h3>
            <!-- Visualization Mode Switch -->
            <div class="viz-switch">
                <button class="viz-btn active" data-viz="depth">Depth Map</button>
                <button class="viz-btn" data-viz="pointcloud">Point Cloud</button>
                <button class="viz-btn" data-viz="nvs">Novel View Synthesis</button>
            </div>

            <!-- Mode 1: Interactive Depth -->
            <div class="viz-content active" id="viz-depth">
                <p><strong>Interactive Depth Comparison:</strong>
                Hover over the RGB image to explore depth details.
                </p>
                <div class="interactive-comparison">
                    <!-- Left: RGB Image --> 
                    <div class="rgb-side" id="rgbSide"> 
                        <img src="images/pub/infinidepth/DSC_6487.png" class="rgb-image" id="rgbImage" alt="RGB Image"> 
                        <div class="magnifier-lens" id="magnifierLens"></div> 
                        <div class="zoom-info" id="zoomInfo">Patch Size: 256×256</div> 
                    </div> 
                    <!-- Right: Depth Map -->
                    <div class="depth-side">
                        <div class="depth-item">
                            <canvas id="depthCanvas1"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mode 2: Point Cloud -->
            <div class="viz-content" id="viz-pointcloud">
                <p><strong>Point Cloud Visualization:</strong>
                Dense point clouds reconstructed from predicted depth. Use mouse to rotate, zoom, and pan.
                </p>
                <div id="pointcloud-container" style="width:100%; height:600px; border-radius:12px; background:#ffffff; position:relative;">
                    <div id="pointcloud-loading" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:#333; font-size:1.1rem;">
                        Loading point cloud...
                    </div>
                </div>
                <div style="margin-top:12px; text-align:center;">
                    <button class="ply-btn active" data-ply="eth_1.ply">ETH Scene</button>
                    <button class="ply-btn" data-ply="waymo_1.ply">Waymo Scene</button>
                </div>
                <style>
                .ply-btn {
                    border: 1px solid #cfd6df;
                    background: #f7f9fc;
                    color: #345;
                    padding: 8px 20px;
                    border-radius: 999px;
                    font-size: 0.93rem;
                    font-weight: 500;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    margin: 0 6px;
                }
                .ply-btn.active {
                    background: #345;
                    color: #fff;
                    border-color: #345;
                }
                .ply-btn:hover:not(.active) {
                    background: #e3eaf2;
                }
                </style>
            </div>

            <!-- Mode 3: NVS -->
            <div class="viz-content" id="viz-nvs">
                <p><strong>Novel View Synthesis:</strong>
                Single-view novel view synthesis under large viewpoint shifts.
                </p>
                <video controls style="width:100%; border-radius:12px;">
                <source src="images/pub/infinidepth/nvs.mp4" type="video/mp4">
                </video>
            </div>

            </div>
        </div>
        </div>
    </div>
    </section>

    <!-- Qualitative Comparison Section -->
    <section>
    <div class="container">
        <div class="row">
        <div class="col-12">
            <div class="section-card">

            <h3 style="font-size:1.5rem; margin-bottom:17px; color:#345; font-weight:600;">
                Qualitative Comparison
            </h3>

            <!-- Visualization Mode Switch -->
            <div class="viz-switch">
                <button class="viz-btn active" data-viz="depth">Depth Map</button>
                <button class="viz-btn" data-viz="pointcloud">Point Cloud</button>
                <button class="viz-btn" data-viz="nvs">Novel View Synthesis</button>
            </div>
            
            <div class="viz-description">

            <div class="viz-desc active" data-viz="depth">
                Predicted <strong>depth maps</strong> from different methods on the same input.
                <span style="color:#61b6f2; font-weight:500;">Blue</span> and
                <span style="color:#f089b9; font-weight:500;">pink</span> boxes highlight regions
                with fine-grained geometric details.
            </div>

            <div class="viz-desc" data-viz="pointcloud">
                Predicted <strong>point clouds</strong> from different methods on the same input.
                <span style="color:#faac59; font-weight:500;">Orange</span> boxes highlight regions
                with fine-grained geometric details.
            </div>

            <div class="viz-desc" data-viz="nvs">
                <strong>Single-View NVS</strong> results under <strong>large viewpoint changes</strong>, e.g. Bird's-eye (BEV) views.
            </div>

            </div>


            <!-- Mode 1: Depth -->
            <div class="viz-content active" id="viz-depth">
                <div style="display:flex; justify-content:center;">
                <img id="depth-main-img"
                    alt="Depth Comparison"
                    style="max-width:100%; border-radius:12px; transition:box-shadow 0.2s;"
                >
                </div>
                <div class="showcase-bar" id="depth-showcase"></div>
            </div>

            <!-- Mode 2: Point Cloud -->
            <div class="viz-content" id="viz-pointcloud">
                <div style="display:flex; justify-content:center;">
                <img id="pcd-main-img"
                    alt="Point Cloud Comparison"
                    style="max-width:100%; border-radius:12px; transition:box-shadow 0.2s;"
                >
                </div>
                <div class="showcase-bar" id="pcd-showcase"></div>
            </div>

            <!-- Mode 3: NVS -->
            <div class="viz-content" id="viz-nvs">
                <div style="display:flex; justify-content:center;">
                <img id="nvs-main-img"
                    alt="Novel View Synthesis Comparison"
                    style="max-width:100%; border-radius:12px; transition:box-shadow 0.2s;"
                >
                </div>
                <div class="showcase-bar" id="nvs-showcase"></div>
            </div>

            </div>
        </div>
        </div>
    </div>
    </section>

    <!-- Acknowledgement Section -->
    <section>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="section-card">
                        <h3 style="font-size:1.5rem; margin-bottom:17px; color:#345; font-weight:600;">Acknowledgement</h3>
                        <p style="text-align: justify;">
                            We thank <a href="https://yuanhongyu.xyz/" target="_blank">Yuanhong Yu</a>, <a href="https://gangweix.github.io/" target="_blank">Gangwei Xu</a> and <a href="https://github.com/ghy0324" target="_blank">Haoyu Guo</a> for their insightful discussions and valuable suggestions, and <a href="https://zhenx.me/" target="_blank">Zhen Xu</a> for his dedicated efforts in curating the synthetic data.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Citation Section -->
    <section>
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="section-card">
                        <h3 style="font-size:1.5rem; margin-bottom:17px; color:#345; font-weight:600;">Citation</h3>
                        <pre><code>@inproceedings{yu2025infinidepth,
                                title={InfiniDepth: Your Paper Title},
                                author={Yu, Hao and Author, Name and Another, Author},
                                booktitle={Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)},
                                year={2025}
                                }</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="text-center" style="margin-bottom: 10px; margin-top: 20px;">
        <p>
            © 2025 Hao Yu. All rights reserved.<br>
            <a href="index.html">← Back to Homepage</a>
        </p>
        <p style="margin-top: 10px; font-size: 0.85rem;">
            Thanks to <a href="https://lioryariv.github.io/" target="_blank">Lior Yariv</a> for the website template.
        </p>
    </footer>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 让每个 section 内的 .viz-btn 只控制本 section
        function setupVizSwitch(section) {
          const btns = section.querySelectorAll('.viz-btn');
          const contents = section.querySelectorAll('.viz-content');
          const descs = section.querySelectorAll('.viz-desc'); // 新增
          btns.forEach(btn => {
            btn.addEventListener('click', () => {
              const target = btn.dataset.viz;
              btns.forEach(b => b.classList.remove('active'));
              btn.classList.add('active');
              contents.forEach(c => c.classList.remove('active'));
              const show = section.querySelector(`#viz-${target}`);
              if (show) show.classList.add('active');
              // 同步切换 description
              descs.forEach(d => {
                if (d.dataset.viz === target) {
                  d.classList.add('active');
                } else {
                  d.classList.remove('active');
                }
              });
            });
          });
        }
        document.querySelectorAll('.section-card').forEach(card => {
          if (card.querySelector('.viz-switch')) {
            setupVizSwitch(card);
          }
        });
    </script>

    <script>
    // 每个 mode 的主图和橱窗图像分别独立配置
    const depthMainImgs = [
      'images/pub/infinidepth/depth/depth1.jpg',
      'images/pub/infinidepth/depth/depth2.jpg',
      'images/pub/infinidepth/depth/depth3.jpg',
      'images/pub/infinidepth/depth/depth4.jpg',
    ];
    const depthThumbs = [
      'images/pub/infinidepth/depth/rgb1.jpg',
      'images/pub/infinidepth/depth/rgb2.jpg',
      'images/pub/infinidepth/depth/rgb3.jpg',
      'images/pub/infinidepth/depth/rgb4.jpg',
    ];
    const pcdMainImgs = [
      'images/pub/infinidepth/vis_pcd/pcd1.jpg',
      'images/pub/infinidepth/vis_pcd/pcd2.jpg',
      'images/pub/infinidepth/vis_pcd/pcd3.jpg',
      'images/pub/infinidepth/vis_pcd/pcd4.jpg',
    ];
    const pcdThumbs = [
      'images/pub/infinidepth/vis_pcd/rgb1.jpg',
      'images/pub/infinidepth/vis_pcd/rgb2.jpg',
      'images/pub/infinidepth/vis_pcd/rgb3.jpg',
      'images/pub/infinidepth/vis_pcd/rgb4.jpg',
    ];
    const nvsMainImgs = [
      'images/pub/infinidepth/nvs.jpg',
      'images/pub/infinidepth/nvs.jpg',
      'images/pub/infinidepth/nvs.jpg',
      'images/pub/infinidepth/nvs.jpg',
    ];
    const nvsThumbs = [
      'images/pub/infinidepth/vis_pcd/rgb1.jpg',
      'images/pub/infinidepth/vis_pcd/rgb2.jpg',
      'images/pub/infinidepth/vis_pcd/rgb3.jpg',
      'images/pub/infinidepth/vis_pcd/rgb4.jpg',
    ];

    function setupShowcase(mainImgId, showcaseId, mainList, thumbList) {
      const mainImg = document.getElementById(mainImgId);
      const showcase = document.getElementById(showcaseId);
      if (!mainImg || !showcase) return;
      showcase.innerHTML = '';
      thumbList.forEach((src, idx) => {
        const thumb = document.createElement('img');
        thumb.src = src;
        thumb.className = 'showcase-thumb' + (idx === 0 ? ' active' : '');
        thumb.alt = 'Showcase Thumb ' + (idx+1);
        thumb.addEventListener('click', function() {
          // 切换主图为主图list中同索引的图片
          if (mainList[idx]) mainImg.src = mainList[idx];
          // 高亮当前 thumbnail
          showcase.querySelectorAll('.showcase-thumb').forEach(t => t.classList.remove('active'));
          thumb.classList.add('active');
        });
        showcase.appendChild(thumb);
      });
      // 初始化主图
      if (mainList[0]) mainImg.src = mainList[0];
    }
    // 初始化
    setupShowcase('depth-main-img', 'depth-showcase', depthMainImgs, depthThumbs);
    setupShowcase('pcd-main-img', 'pcd-showcase', pcdMainImgs, pcdThumbs);
    setupShowcase('nvs-main-img', 'nvs-showcase', nvsMainImgs, nvsThumbs);
    </script>

    <!-- InfiniDepth Scripts -->
    <script src="js/infinidepth/config.js"></script>
    <script src="js/infinidepth/magnifier.js"></script>

    <!-- Point Cloud Viewer Script -->
    <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
    import { PLYLoader } from 'three/addons/loaders/PLYLoader.js';

    (function() {
        let scene, camera, renderer, controls, currentPointCloud;
        const container = document.getElementById('pointcloud-container');
        const loading = document.getElementById('pointcloud-loading');

        // Initialize Three.js scene
        function initPointCloudViewer() {
            console.log('Initializing Point Cloud Viewer...');

            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xffffff); // 白色背景

            // Camera
            camera = new THREE.PerspectiveCamera(
                60,
                container.offsetWidth / container.offsetHeight,
                0.1,
                1000
            );
            camera.position.set(0, 0, 5);

            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(container.offsetWidth, container.offsetHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            container.appendChild(renderer.domElement);

            // OrbitControls - 交互式控制，完全自由旋转
            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.screenSpacePanning = true; // 允许屏幕空间平移
            controls.minDistance = 0.5;
            controls.maxDistance = 100;
            // 移除旋转限制，允许360度旋转
            // controls.maxPolarAngle = Math.PI; // 删除这行

            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
            scene.add(ambientLight);

            const directionalLight1 = new THREE.DirectionalLight(0xffffff, 0.5);
            directionalLight1.position.set(1, 1, 1);
            scene.add(directionalLight1);

            const directionalLight2 = new THREE.DirectionalLight(0xffffff, 0.3);
            directionalLight2.position.set(-1, -1, -1);
            scene.add(directionalLight2);

            // 移除网格辅助线
            // const gridHelper = new THREE.GridHelper(10, 10, 0x444444, 0x222222);
            // scene.add(gridHelper);

            // Handle window resize
            window.addEventListener('resize', onWindowResize);

            // Animation loop
            animate();

            console.log('Point Cloud Viewer initialized successfully');
        }

        function onWindowResize() {
            if (!container) return;
            camera.aspect = container.offsetWidth / container.offsetHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.offsetWidth, container.offsetHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        // Load PLY file
        function loadPLY(filename) {
            console.log('Loading PLY file:', filename);
            if (loading) {
                loading.style.display = 'block';
                loading.textContent = 'Loading point cloud...';
                loading.style.color = '#333';
            }

            // Remove existing point cloud
            if (currentPointCloud) {
                scene.remove(currentPointCloud);
                currentPointCloud.geometry.dispose();
                if (currentPointCloud.material) currentPointCloud.material.dispose();
            }

            const loader = new PLYLoader();
            const plyPath = 'images/pub/infinidepth/pointclouds/' + filename;

            loader.load(
                plyPath,
                function(geometry) {
                    console.log('PLY loaded successfully, vertices:', geometry.attributes.position.count);

                    // 翻转 X 和 Y 轴
                    const positions = geometry.attributes.position.array;
                    for (let i = 0; i < positions.length; i += 3) {
                        positions[i] = -positions[i];     // 翻转 X 坐标
                        positions[i + 1] = -positions[i + 1]; // 翻转 Y 坐标
                    }
                    geometry.attributes.position.needsUpdate = true;

                    // Center and scale the geometry
                    geometry.computeBoundingBox();
                    const center = new THREE.Vector3();
                    geometry.boundingBox.getCenter(center);
                    geometry.translate(-center.x, -center.y, -center.z);

                    // Auto-scale to fit in view
                    const size = new THREE.Vector3();
                    geometry.boundingBox.getSize(size);
                    const maxDim = Math.max(size.x, size.y, size.z);
                    const scale = 3 / maxDim;
                    geometry.scale(scale, scale, scale);

                    // Create material
                    const material = new THREE.PointsMaterial({
                        size: 0.01,
                        vertexColors: true,
                        sizeAttenuation: true
                    });

                    // Create point cloud
                    currentPointCloud = new THREE.Points(geometry, material);
                    scene.add(currentPointCloud);

                    if (loading) loading.style.display = 'none';

                    // Reset camera position
                    camera.position.set(0, 2, 5);
                    controls.target.set(0, 0, 0);
                    controls.update();
                },
                function(xhr) {
                    const percent = (xhr.loaded / xhr.total * 100).toFixed(0);
                    console.log('Loading progress:', percent + '%');
                    if (loading) loading.textContent = `Loading point cloud... ${percent}%`;
                },
                function(error) {
                    console.error('Error loading PLY:', error);
                    if (loading) {
                        loading.textContent = 'Error loading point cloud. Please check the browser console.';
                        loading.style.color = '#ff6b6b';
                    }
                }
            );
        }

        // Setup button controls
        function setupPLYButtons() {
            const buttons = document.querySelectorAll('.ply-btn');
            buttons.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Update active button
                    buttons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');

                    // Load corresponding PLY file
                    const plyFile = btn.dataset.ply;
                    loadPLY(plyFile);
                });
            });

            // Load first PLY file by default
            if (buttons.length > 0) {
                const firstPly = buttons[0].dataset.ply;
                loadPLY(firstPly);
            }
        }

        // Initialize when Point Cloud tab is shown
        const vizBtns = document.querySelectorAll('.viz-btn[data-viz="pointcloud"]');
        vizBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                console.log('Point Cloud tab clicked');
                // Delay initialization to ensure container is visible
                setTimeout(() => {
                    if (!renderer) {
                        initPointCloudViewer();
                        setupPLYButtons();
                    } else {
                        onWindowResize();
                    }
                }, 100);
            });
        });
    })();
    </script>
</body>
</html>
